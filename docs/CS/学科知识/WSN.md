 # 概述

无线传感网络(Wireless Sensor Network)  
 
最早可追溯到 20 世纪 70 年代，在越南战争时期，当时使用的是传统的传感器系统，这些系统由震动和声响传感器组成，用于监控“胡志明小道”。  

无线传感网络中，最主要的传输介质是 **无线电波**  

无线传感器网络(WSN)是大量的静止或移动的传感器以自组织和多跳的方式构成的无线网络，目的是协作地采集、处理和传输网络覆盖地域内感知对象的监测信息，并报告给用户。  

## WSN中网络结构和特点

结构：  
节点可以组成三种拓朴结构：星型结构、网状结构(Mesh)和簇状结构(Cluster tree)。节点以自组织形式构成网络、每个节点都可以自主采集数据，数据通过单跳方式或多跳中继方式送到汇聚节点(Sink节点)。汇聚节点将收集的数据发送到远程的控制中心，或通过串接口把数据发送给PC 机进行数据处理和存储。

特点：  
(1)网络节点密度高，数量大；  
(2)节点的计算和存储能力有限；  
(3)节点体积微小，通常携带能量十分有限的电池，节点能量有限；  
(4)通信能力有限，传感器网络的通信带宽较窄，节点间的通信单跳距离通常只有几十到几百米，因此在有限的通信能力下如何设计网络通信机制以满足传感器网络的通信是必须考虑的问题；  
(5)各传感器节点位置随机分布，具有自组织特性。

### 在无线传感器网络中，节点能量的主要消耗模块是什么？造成网络能量浪费的主要原因有哪些？

答：无线通信模块是传感器节点能量的主要消耗者。  
造成网络能量浪费的主要原因：冲突、串扰 （串音）、空闲监听（降低占空比）、控制开销  

## 节点

汇聚节点通常又被称作 网关  

无线传感网的覆盖问题是WSN网络配置首先面临的基本问题，它反映了一个无线传感器网络某区域______被检测和跟踪的状况______。  

## 节点的组成

###  硬件

传感器模块（传感器（敏感元件、转换元件、信号调理转换电路）、AC/DC）、处理器模块（处理器、存储器）、无线通信模块（网络、MAC、收发器）、电源

计算模块、传感模块、**通信模块**、存储模块和电源模块

### 嵌入式软件

## 网络、节点的特点

- 传感器节点体积小，能量有限（注重能量高效利用）
- 数量众多
- 自组织网络（节点能自动进行组网）
- 通过多跳方式传输（节点传输距离有限）
- 以数据为中心的网络

## 网络协议栈

5 层

物理层、数据链路层、网络层、传输层、应用层  

各层协议和平台的功能：  
①物理层提供简单但健壮的信号调制和无线收发技术。  
②数据链路层负责数据成帧、帧检测、媒体访问和差错控制。  
③网络层主要负责路由生成与路由选择。  
④传输层负责数据流的传输控制，是保证通信服务质量的重要部分。  
⑤应用层包括一系列基于监测任务的应用层软件。  

⑥能量管理平台管理传感器节点如何使用能源，在各个协议层都需要考虑节省能量。  
⑦移动管理平台检测并注册传感器节点的移动，维护到汇聚节点的路由，使传感器节点能动态跟踪其邻居位置。  
⑧任务管理平台在一个给定的区域内平衡和调度监测任务。  

# 物理层与信道的接入技术

## 频率分配

6 GHz 以下频段的波形可以进行很好的整形处理。  

无线电波：在自由空间全方位传播的射频频段的电磁波，可以很容易产生，也可以穿透建筑物体，因此被广泛应用于无线通信中。

ISM频段：对所有无线电系统都开放的频段，发射功率要求在 1W 以下，无需任何许可证。

## 物理层设计

目标：以尽可能少的能量小号获得较大的链路容量。  
考虑：编码调制技术，通信速率，通信频段等

### 调制技术

窄带调制技术、扩频调制技术、超宽带UWB调制技术  

### 通信频段

在无线通信中，频率的选择需要考虑哪些方面的因素？（每一点请简要阐明）  
```
从天线长度的角度:当天线的长度为无线电信号波长的1/4时，天线的发射和接收转换效率最高  
从功耗的角度: 载波频率越高消耗能量越多  
从节点物理层集成化的角度: 更高的频率更易于电感的集成化设计  
```


1. 低**成本**的要求，使用 ISM 频段
2. 信号在不同频段上的传播特性、功率消耗记忆以及对器件性能和天线要求有很大区别。
3. 频率低，天线就要长，**体积**就会变大
4. 传播距离相同，频率越高，**能量消耗**越大。


## 信道接入技术

无线信道的使用方式是由媒体访问控制（MAC）协议决定的。  
无线通信模块是节点能量的主要消耗者，而 MAC 子层直接与物理层连接，即 MAC 协议直接控制无线射频收发器的活动，决定何时接收发送数据。  

MAC 协议评价：
- 能源有效性。节能
- 可扩展性。动态变化
- 性能的综合测评。没有短板
- 分布式算法。多节点协同计算
- 可靠性。检测、修复

![alt text](AAA_PictureDir_1_WSN/MAC.jpg)

### 基于竞争的 MAC 协议

基本思想：  
**传感器节点发送数据时，以某种竞争机制访问无线信道；如果产生了碰撞，就按照某种策略重新发送数据，直到数据发送成功或放弃发送。**  

#### IEEE 802.11 MAC 协议

IEEE 802.11 MAC 协议有分布式协调（DCF）和点协调（PCF）两种访问控制方式。
*该协议中的点协调（PCF）访问控制方式是一种基于优先级的无竞争访问*  
DCF 是通过物理载波侦听（由物理层提供）和虚拟载波侦听（MAC 层提供）来确定无线信道的状态

#### S-MAC 协议

最重要的改进：  
引入了周期性**侦听**/**睡眠**的低占空比机制，通过控制节点的周期性睡眠来降低能耗  

简述S-MAC的基本思想  
减少空闲侦听时间，避免了传输碰撞和串音现象，减少了协议控制开销，节省了能量开销。  

##### S-MAC 工作原理

答：
1. 采用周期性的休眠/侦听方法减少空闲侦听带来的能量损耗;S-MAC把时间分割成许多时隙，在每个时隙中又划分为侦听和睡眠两个状态
2. 当有节点收发数据时，与此无关的邻居节点进入休眠减少冲突与串音带来的能量损耗；
3. 采用消息传递机制，减少控制消息带来的能量损耗；
4. 采用自适应的侦听机制，减少消息传输延迟。

#### T-MAC 协议

解决**早睡问题**  
- **未来请求发送**
- 满缓冲区优先

##### T-MAC的工作原理

各节点周期性被唤醒，进入活动期，并在活动期间与相邻节点进行通信，然后进入休眠状态，直到下一帧到来。  
如果在指定时间内没有需要处理的激活事件发生，节点进入休眠状态。  
激活事件为：周期帧定时器溢出；信道上收到数据包；检测到信道上有通信在进行；节点数据包或确认信息发送完毕；相邻节点数据包发送完毕

#### Sift 协议

---

### 基于固定分配的 MAC 协议

常见的有 TDMA、FDMA、CDMA、SDMA。在能量节省上有天然优势（没有竞争产生额外开销），但不能动态改变帧的长度和时隙/频率的分配，扩展性不好。

#### TDMA 技术

时分复用（Time Division Multiple Access）

#### DEANA 协议

#### TRAMA 协议

#### DMAC 协议

#### CDMA 技术

---

### 基于按需分配的 MAC 协议

#### PCF 方式

#### WTRP 方式

---

### ZigBee 技术

[ZigBee学习笔记——（三）ZigBee无线传感器网络通信标准](https://blog.csdn.net/qq_44526422/article/details/110873419)

#### 概述

IEEE 802.15.4 技术标准是 ZigBee 技术的基础。

IEEE 802.15.4 只处理低级 MAC层和物理层协议，ZigBee 联盟对其网络层协议和 API 进行标准化。

ZigBee 技术是一种近距离、低复杂度、低功耗、低速率、低成本的双向无线通信技术。

主要应用于距离短、功耗低且传输速率不高的各种电子设备之间进行数据传输以及典型的有周期性数据、间歇性数据和低反应时间数据传输的应用。

![alt text](AAA_PictureDir_1_WSN/image-1.png)

#### 技术特点

![alt text](AAA_PictureDir_1_WSN/image.png)

| 特性       | 描述                                                                                   |
|------------|----------------------------------------------------------------------------------------|
| 功耗低     | -ZigBee 网络节点设备工作周期短，收发数据信息功耗低<br>-且使用休眠模式（当不需要接收数据时处于休眠状态，需要接收数据时由“协调器”唤醒）。 |
| 成本低     | -协议栈设计简单，研发和生产成本低<br>-普通节点只需要 8 位处理器，4~32KB 的 ROM，且软件实现简单<br>-模块便宜。 |
| 可靠性高   | -采用碰撞避免机制（PAN ID）。                                                           |
| 容量大     | -**一个 ZigBee 网络最多可以容纳 254 个从设备和 1 个主设备，一个区域最多可以同时存在 100 个 ZigBee 网络。** |
| 时延小     | -通信时延和从休眠状态到激活的时延都非常短，因此 ZigBee 技术适用于对时延要求苛刻的无线控制领域。 |
| 安全性好   | -ZigBee 技术提高了数据完整性检查和鉴权功能，加密算法使用 AES-128。                       |
| 有效范围小 | -有效范围为 10~75 m 之间，具体依据实际发射功率的大小和各种不同的应用模式。               |
| 兼容性     | -ZigBee 技术与现有的控制网络标准无缝集成。                                               |

#### 协议框架

![alt text](AAA_PictureDir_1_WSN/image-2.png)

完整的 ZigBee 协议栈共分为 4 层

物理层 MAC层 网络层（**核心部分**） 应用层 

#### 网络层规范

网络层数据帧结构中，半径域中的数字表示 **数据包传送时，所经过的节点的跳数**

网络层只要实现节点加入、离开、路由查找和传送数据等功能。

目前，ZigBee 网络层主要支持两种路由算法：
- 树状路由（Cluster-Tree）  
    树状路由把整个网络看作是以协调器为根的一棵树，树状路由不需要路由表，节省存储资源；  
    缺点是不灵活，浪费大量地址空间，路由效率低。  
- 网状网路由  
    是AODV的一个简化版本  

支持多种拓扑结构：
- 星状
- 树状
- 网状

---

# 路由、覆盖与拓扑技术

## 路由

路由的作用是寻找一条或多条满足一定条件的，从源结点到目的节点的路径，将分组沿着所寻找的路径进行转发。  
- 优化路径
- 转发资料分组

![alt text](AAA_PictureDir_1_WSN/luyou1.jpg)

### 简单的无结构的路由协议

#### Flooding 和 Gossiping 协议

Flooding  
基于洪泛机制的路由协议  
漏洞  
- 信息内爆
- 部分重迭
- 网络资源利用不合理

Flooding路由协议的基本思想以及主要缺陷是什么？  
基本思想：  
每个节点接收到数据后，会将该数据广播转发给所有相邻的节点，直到数据到达目的地或达到设定的生存期限（TTL）为止。  

Gossiping  
对 Flooding 的改进  
只转发给邻居节点中的某一个不同节点（避免信息内爆）  

### 以数据为中心的路由协议

#### 信息协商传感协议-SPIN 路由协议

SPIN 协议通过节点之间的协商，解决Flooding协议和Gossiping协议的内爆和重叠问题。  

采用三种类型的数据包：ADV、REQ、DATA。
- ADV  
    路由请求发去的数据包  
    某一个节点接收到数据包时，它会向周围节点广播该数据包，以通告是否接收数据  
    体积小，消耗资源少  
- REQ  
    请求响应数据包  
- DATA  
    传感采集的数据内容  
    单播给发送了 REQ 数据包的节点  

#### 定向扩散路由协议 DD路由

汇聚节点传播兴趣消息的方式是 洪泛（广播）方式  

定向扩散路由协议采 周期性地对网络进行路由维护与更新，其主要分为3个阶段：兴趣消息
扩散、数据传输梯度建立和_________路径加强__________。  

#### 谣传路由协议

谣传路由协议借鉴了欧式平面几何中的_________任意两条曲线相交概率较大_________的原理。  

谣传路由协议寻找可行路径的方式是：  
从源节点和汇聚节点均发送数据包，两者都随机进行下一跳节点，直到两个数据包在某一节点
上相交，则构成了一条可行路由  

### 基于层次结构（树结构）的路由协议

根据拓扑结构划分为若干个簇  

树根节点是从（ 汇聚节点的邻居节点 ）开始的  

#### 高弹性多路径路由协议

#### SAR 路由协议

#### LEACH-自适应低功耗路由协议

首次提出了簇头选举算法  

簇头随机选取  
簇头节点能耗大大增加，会过早死亡  

简述LEACH协议工作的主要阶段。  
1. 选举簇头阶段：在每一轮的开始时，通过随机算法选出一些节点作为簇头节点。这些簇头节点负责协调和管理簇内的数据传输。每个节点产生一个随机数，如果这个随机数小于设定的阈值，则该节点成为簇头节点。簇头节点的选择是基于网络所需的簇头节点数和节点成为簇头节点的次数来决定的。
2. 成簇阶段：簇头节点选定后，会向周围广播消息，邻近节点根据信号的强度选择加入相应的簇头，并通知相关的簇头。簇头节点再采用TDMA方式为簇内每个节点分配传输数据所需的时片。在这个阶段，所有非簇头节点将本身所采集的数据发送给相应的簇头节点。
3. 稳定状态阶段：在这个阶段，簇头节点对簇内节点的数据进行数据融合处理，然后再发送给sink节点（基站）。稳定阶段的持续时间要比簇的建立阶段所需时间大，以节省频繁选择簇头带来的能量开销。在稳定阶段，非簇头节点在没有发送数据时，将进入休眠状态以节省能量，而簇头节点保持工作状态以接收数据。

LEACH协议通过动态簇头选举和轮换机制，有效避免了虚假路由攻击。  
 
#### PEGASIS 及 Hierarchical-PEGASIS 路由

只采用一个簇头，其将全网看成是一个簇群，并将其称为链  
只有簇头节点能与汇聚节点进行通信  
每个节点必须知道自己的所在地理位置  

#### TEEN 和 APTEEN 路由协议

其对超过阀值的数据比较敏感，主要是通过（ 硬门限与软门限共同决定 ）实现的  
节点在第一次给簇头节点上报数据时，只上报值大于_______硬门限_______的值。  

主要缺点是：  
因为阀值的设置，造成有些数据不能上报  

简述分层次的路由协议中的节能的阈值敏感的传感器网络协议（TEEN协议）工作原理。  
TEEN协议引入了两个参数值：硬门限与软门限。在数据传输过程中，仍采用 TDMA 的机制，首先由汇聚节点向网络中传感器节点广播硬门限值，则传感器节点根据这个硬门限值，在第1次将监测到的数据上报给簇头节点时，仅仅上报其值大手硬门限的数据，并将当前的监测数据保存为监测值。在这之后监测到的数据则根据硬门限与软门限两者共同决定是否需要上报给簇头节点，凡是数值大于硬门限值且与SV之差的绝对值不小于软门限时，节点才向簇头上报数据，并将当前观测到的数据作为最新的SV。  

### 基于地理信息路由协议

基于地理位置路由协议，是把节点的（ 位置 ）信息作为路由选择的依据。

#### PALR 局部地理拓扑的单播路由协议

每个传感器节点 知道自己、目标节点与其邻居节点的地理位置信息  

#### LBM 改善的多播协议

##### 转发域的3种类型  

*基于地理位置信息改善的多播路由协议LBM中，定义了哪些转发域？(简答题)*   

静态转发域：将目标域与源节点限制在一定范围空间中，从而将节点的数据转发范围缩小，降低广播通信量。  
自适应转发域：转发域随着数据包转发进行相应的变化。  
基于前进距离的非显示转发域：转发区域时刻变化且无固定形状，时刻根据节点自身计算值变化；  
*基于前进距离的非显示转发域，是指两个节点与目的节点的距离之差**大于**一个设定的值，才进行数据的转发*  

#### GRID 基于地理栅格的分层路由协议

基本思想是将网络划分成多个正方形的小珊格，相邻珊格中的______任意两簇头节点______可直接通信。  

基于地理栅格的分层网络路由协议GRID协议中，设栅格的边长为d，节点的通信距离为r，则二者之间的关系为__r=(根号5)d___。  

### 基于多路径的路由协议

。。。

---

## 拓扑控制技术

拓扑控制算法在网络协议分层中，对应于（ MAC层与路由层之间 ）  

节点的覆盖率 C的值，越___大____越好。  

### 功率控制技术

#### COMPIW 统一功率分配算法

基本思想：  
所有传感器使用统一的功率，在保证网络连通的前提下将功率最小化。

各节点的通信发射功率（ 在初始时设置为最大发射功率 ），逐渐降低至所需最小功率

#### 基于节点度的功率控制 LMN/LMA

节点的度是指（ 距离该节点一跳的邻居节点的数目 ）  

局部平均算法 LMN（Local Mean Algorithm）  
将所有邻居节点的邻居数求平均作为自己的邻居数。  

本地邻居平均算法 LMA （Local Mean of Neighbors Algorithm）  
主要思想：  
给定节点度的上下限，动态调整节点的发射功率，使结点的度落在要求的范围内。  

### 层次型拓扑控制方法

#### LEACH

#### HEED

通过定义簇内平均最小可达功率指标来衡量簇内节点的通信成本。  

### 休眠调度技术

#### STEM

两种不同的机制  
- STEM-B（Beacon）
    每个睡眠节点周期性起来侦听信道
- STEM-T（Tone）
    相比 B ，省略了请求应答过程，但增加了节点唤醒次数，更简单

#### ASCENT

。。。

## 无线传感网络覆盖技术

### 感知模型

布尔模型  
简单  

概率感知模型  
复杂

### 覆盖算法分类

#### 节点部署方式分类

节点的部署方式有两种，一种是确定性部署，另一种是___随机部署_____。  

#### 覆盖目标分类

面覆盖、点覆盖、栅栏覆盖

### 典型的覆盖算法与协议

#### 基于网格的覆盖定位传感器配置算法

#### 连通传感器覆盖算法

目标：  
选择最小的连通传感器节点集合并充分覆盖网络区域  

新加入的节点，能够达到最大化的网络覆盖  

#### 轮换活跃/休眠节点的 Self-Scheduling 覆盖协议

为了避免邻居节点同时进入休眠状态而出现“盲点”，各节点在进入“休眠状态”之前还将___等待Tw时间来监听邻居节点的状态更新___。  

#### 最坏与最佳情况覆盖算法

- 最大化突破路径  
    无线传感器网络最坏（被检测概率最小）  
    路径上的点到周围最近传感器的最小距离最大化  
- 最大支撑路径
    无线传感器网络最佳（被检测概率最大）  
    路径上的点到周围最近传感器的最大距离最小化

无线传感网中的最大突破路径，一定是由（ 各节点的连线的中垂线组成 ）  

---

# 无线传感器网络定位、跟踪与时间同步技术

实际应用中两种意义：  
- 确定自己在系统中的位置
- 确定目标在系统中的位置

分类：  
1. 基于测距的定位和无需测距的定位
2. 绝对定位和相对定位
3. 集中式计算、分布式计算与递增式计算

## 测距技术

术语：  
1. 接受新信号强度指示（Received Signal Strength Indicator，RSSI）：节点接受无线信号强度的大小  
2. 到达角度（AOA）
3. 视线（Line of Sight，LOS）关系：两个节点之间没有障碍物间隔，能够直接通信
4. 非视线关系

到达时间测量法  
到达时间差测量法  
到达信号强度测量法  

## 定位机制与性能评价标准

### 机制

三边定位法  
多边极大似然估计法  
角度测量法  

如果已知3个参考节点的坐标和它们到未知节点的距离，则可以使用_____三边定位______法来实现对未知节点坐标的求解。  

如果未知节点已知3个以上的参考节点的坐标和它们到未知节点的距离，则可以使用__多边极大似然估计__法来实现对未知节点坐标的求解。该方法相对于三边定位法更加_复杂、准确_。

### 评价

。。。

## 现有定位方法

节点的定位通常是通过（ 节点通过锚点，并运行相应的定位算法，计算出自己的位置 ）来实现的  
定位算法中，位置信息可分为物理位置和______符号_____位置两类。  

在GPS 定位中，要获得地面的被测目标的位置信息，则至少需要同时接收到____3___颗GPS卫星的信号。  

### Cricket 定位系统

基于 TDOA  
分布式管理  
通过测量未知节点最近的信标节点计算静止或者移动目标在大楼内具体房间的哪一区域，而不是绝对位置。  

### 质心定位算法

一种与距离无关的估计定位算法  
多边形顶点坐标的平均值为质心坐标  

### TOA 和 TDOA 定位方法

基于TDOA的定位算法中，要计算出未知节点的位置信息，则至少需要___3___个参考节点。  

在基于TDOA的测距中，如果利用波速差来进行测距，其主要缺点是 要产生和接收两种不同的信号波，节点硬件较复杂  

在基于TDOA的定位算法中，如果利用距离差测距方法来实现定位，则要求 参考节点之间的时间完全同步  

### AOA 定位方法

基于到达角度  
基于AOA的定位算法中，要计算出未知节点的位置信息，则至少需要___2___个基站节点。  

### RSSI

信号强度与节点间距离平方成反比  

### DV-HOP

三个阶段  
1. 计算未知节点与每个信标节点的最小跳数
2. 计算未知节点与每个信标节点之间的距离
3. 计算未知节点的坐标

如果某未知节点收到了来自同一个信标节点的不同跳数值，则（ 取最小的跳数值 ）  
某未知节点在接收信标节点发送的每跳平均距离时，（ 只记录第一个接收到的每跳平均距离 ）  

## 跟踪技术

基本过程：  
1. 检测阶段
2. 定位阶段
3. 通告阶段

无线传感器网络跟踪技术，按照传感器节点运动方式的不同，可以分为静态目标侦测和_______动态目标跟踪________。  
传感器网络的目标跟踪的实质是____________协作跟踪的过程__________。  

## 时间同步技术

### 时间同步模型

#### 时钟模型

##### 节点本地时钟模型  

- 速率恒定模型
- 漂移有界模型
- 漂移变化有界模型

确定时钟的精度或误差的上下界的时钟模型是______漂移有界模型______。  

##### 节点逻辑时钟模型  

#### 通信模型

**节点时间校正技术**是无线传感网络时间同步技术的核心和基础  

节点的时间校正技术是建立在（ 节点间互相交换时间信息 ）基础之上的  

##### 单向报文传递

##### 双向报文交换

##### 广播参考报文

在广播参考报文时间同步算法中，其第三个节点发送的广播信息中，（ 广播信息作为接收节点的时钟同步参考 ）  

##### 参数拟合技术

##### 时间同步的误差来源

1. 协议发送时延  
    数据包由高层传递到低层时，需要对数据包封装  
2. 接入时延  
    链路层等待信道空闲的时间  
    受网络流量影响较大  
3. 发送时延  
    物理层发送数据包的时间受包长及速率影响  
    受包长及速率影响  
4. 传播时延  
5. 接收时延  
6. 接收处理时延  

### 时间同步协议

#### 时间同步类别  

- 时钟速率同步与偏移同步  
- 同步期限：长期同步与按需同步  
- 同步范围：全网同步与局部同步  
- 内同步 外同步  
    每个节点都与外部时间标度（如UTC，世界标准时间）保持同步，这种同步被称为（ 外同步 ）  
- 发送者-接收者同步 接收者-接收者同步  

#### 典型的同步协议

##### LTS 协议（Lightweight Tree-based Synchronization）

基于双向报文交换  
构建的生成树的深度越小越好  
LTS 算法包括两种同步方式：集中式和分布式  
LTS 算法中的分布式同步中，未利用生成树，而是按已有的路由机制寻找参考点  

关于LTS时间同步算法中，错误的是（ 上层节点与下层节点采用广播方式进行时间同步 ）  

##### RBS 协议 广播报文时间同步算法

在RBS 时间同步算法中，对于两个接收节点，RBS机制需要____3____个发送消息和____4____个接收消息。  

简述参考广播报文时间同步算法工作原理。 (简答题)   
1. 节点广播时间信息：在网络中选择一个节点作为主节点，它负责生成并周期性地广播包含当前时间信息的时间同步报文。这个报文通常包括主节点的时钟时间、序列号以及其他必要的控制信息。
2. 从节点接收并处理报文：网络中的其他节点（从节点）监听主节点的广播报文。当从节点接收到时间同步报文时，它会记录下接收到该报文的本地时间，并根据报文中的主节点时间来计算时间偏差。
3. 计算时间偏差：从节点使用接收到的报文时间与本地接收时间的差值来估算与主节点之间的时间偏差。这个过程可能会涉及到多次测量以提高准确性，比如采用最小二乘法或其他统计方法来减少随机误差的影响。
4. 调整本地时钟：根据计算出的时间偏差，从节点可以调整自己的本地时钟，使其尽可能接近主节点的时钟。这可能涉及到直接设置本地时钟或者逐渐调整时钟频率以匹配主节点的时钟。
5. 重复同步过程：为了保持时间同步的准确性，上述过程会定期重复进行。主节点继续广播时间同步报文，而从节点则不断接收这些报文并更新它们的时间偏差估计和本地时钟。
6. 考虑传输延迟：在实际的时间同步过程中，还需要考虑报文在网络中传输的延迟。虽然参考广播报文算法本身不直接测量和补偿这个延迟，但可以通过设计更复杂的协议来进一步减小由于传输延迟引起的同步误差。

![alt text](AAA_PictureDir_1_WSN/image-3.png)

##### TPSN（Timing-sync Protocol for Sensor Networks）时间同步算法

TPSN（Timing-sync Protocol for Sensor Networks）时间同步算法的通信模型是基于（ 双向报文交换 ）的同步算法。  

原理：  
**拓扑建立阶段**  
1. 初始化  
    选择一个或多个根节点（通常是由基站或具有较高能量储备的节点担任），这些根节点将作为同步的参考点。  
2. 洪泛消息传播  
    根节点发送洪泛消息（Flood Message），该消息包含发送者的ID、跳数（初始值为0）和其他必要的信息。每个接收到此消息且尚未加入层次结构的节点会将自己的跳数值加1，并继续向其邻居转发该消息，直到所有节点都加入了层次结构。  
3. 构建层次结构  
    通过上述过程，网络中的每个节点都知道了它距离根节点的跳数，从而形成了以根节点为中心的树状层次结构。在这个结构中，距离根节点较近的节点处于较低层，而距离较远的节点则位于较高层。

**同步建立阶段**  
1. 时间戳交换  
    在这个阶段，每一对相邻层的节点之间进行时间戳交换来计算偏移量。具体来说，父节点（即低一层的节点）会定期向其子节点（高一层的节点）发送带有精确时间戳的消息。  
    子节点接收到来自父节点的消息后记录下本地时间戳，并且回复一个确认消息给父节点，这个确认消息也包含了子节点的本地时间戳。  
2. 偏移量计算  
    父节点利用从子节点收到的确认消息中的时间戳以及自己发出消息时的时间戳，计算出两者之间的时钟偏移量。  
    这个偏移量反映了子节点相对于父节点的时钟偏差，子节点可以根据这个信息调整自己的时钟，使得它与父节点保持一致。  
3. 同步传播  
    这种父子节点间的时间同步过程沿着层次结构逐层向下传播，最终整个网络内的所有节点都能够与根节点达到较高的时间同步精度。  
![alt text](AAA_PictureDir_1_WSN/image-4.png)

在双向报文交换时间同步算法中，设源节点S在本地时间T1时刻向目标节点R发送同步消息，R节点在其本地时刻T2收到该消息，T3时刻将该消息返回给S节点，S节点在T4时刻收到该消息。设两节点间消息传递时延为d，两节点时钟偏差为Δt。请根据下图写出时延d、时钟偏差Δt的计算公式。(简答题)   
![alt text](AAA_PictureDir_1_WSN/image-5.png)  
![alt text](AAA_PictureDir_1_WSN/image-6.png)  

##### DMTS（DelayMeasurementTimeSynchronization，延迟测量时间同步协议）

以下关于DMTS（DelayMeasurementTimeSynchronization，延迟测量时间同步协议），错误的说法是（B ）(单选题)  
A、 其通过对同步报文在传输路径上所有的延迟进行估计来实现节点间的时间同步  
B、 同步报文在传输路径上采用双向通信方式以进行时间同步  
C、 通过广播同步报文，能够一次广播就同步单跳广播域中的所有节点  
D、 未考虑传播延迟、没有估算时钟频偏等，因此精度不高  

##### FTSP（FloodingTimeSynchronizationProtocol）算法

以下关于FTSP（FloodingTimeSynchronizationProtocol）算法，错误的是（C ）(单选题)  
A、 FTSP算法也是使用单个广播消息实现发送节点与接收节点之间的时间同步  
B、 FTSP算法可以看成是DMTS协议的改进算法  
C、 FTSP算法无需进行双向数据包交换，因此实现简单，但精度不高  
D、 FTSP算法在DMTS协议的基础上，提出了一系列降低时延不确定的策略，算法较复杂  

---

# 无线传感器网络安全   

## 概述

### 需求

- 机密性  
    使用通信双方共享的会话密钥来加密待传递的消息  
- 真实性  
- 完整性  
    信息在网络中传递时，需要保证数据没有被篡改或替换  
- 新鲜性  
    可以避免网络中的（ 重放 ）攻击  
- 扩展性
- 可用性
- 自组织性
- 鲁棒性

### 攻击与威胁

#### 分类

攻击者的能力：  
- Mote-class  
    攻击者的资源和普通节点相当  
- Laptop-class  
    攻击者拥有更强的设备和资源  
    危害更大  

攻击者的类型：  
- 内部攻击  
- 外部攻击  

#### 常见攻击

##### DoS 攻击

攻击者通过向目标节点发送大量数据，而使目标节点无法正常工作的攻击手段  

##### Sybil 攻击

##### Sinkhole 攻击

使用功能强大的处理器来代替受控节点，吸引所有的数据流通过攻击者所控制的节点进行传输  

##### Wormhole 攻击

##### Hello 洪泛攻击

攻击者使用大功率无线设备来广播、路由，吸引网络中的部分甚至全部节点向其发送数据  

##### 选择转发攻击

### 安全框架

在无线传感器网络的安全设计时，通常要采用跨层设计的方式，其主要原因是（ 安全需求与网络性能的折中处理 ）  

## 密码学理论

### 选择

速度快 空间小 开销小 易于实现 多样化  

- RC5/RC6 分组加密算法  
    属于对称密钥加密算法
- 非对称椭圆曲线加密  
- 基于 ID 或 Hash 函数的加密方式

### 密钥管理

#### 密钥管理技术的安全及性能需求  

##### 安全需求

- 密钥生成或更新算法的安全性
- 前向私密性  
    退出或被俘的节点，不能再进入网络，是指无线传感器网络应具有（ 前向私密性 ） 
- 后向私密性和可扩展性  
    新加入的节点具有合法性，可以进入网络，是指无线传感器网络应具有（ 后向私密性 ）  
- 一定程度上的抗同谋破解
- 源端认证性和新鲜性  
    WSN 网络的源端认证性，是指（ 数据包可追溯 ）  


##### 性能需求

P111

#### 密钥管理分类

##### 对称与非对称密钥管理方案

##### 分布式和层簇式的密钥管理方案

当前WSN网络密钥管理方案研究的主流是（ 层簇式密钥管理 ）  

##### 按照网络运行后密钥是否更新分类

P112

##### 网络密钥链接性分类

P112

# 操作系统

现有的无线传感器网络数据存储结构主要包括四个类型： 网外集中式存储方案 、__网内分层存储方案___、___网内本地存储方案___、以数据为中心的存储方案 。  

数据查询可以根据查询要求的时间特性分成三种类型：___历史查询____、__快照查询___、__连续查询____。  

以下无线传感器网络接入基础网络的方式中，传输速度最快的是（C ）。(单选题)  
A、 GPRS接入  
B、 CDMA接入（3G）  
C、 WLAN接入（WIFI）   
D、 卫星接入  

以下无线传感器网络接入基础网络的方式中，延时最高的是（D ）。(单选题)  
A、 GPRS接入  
B、 CDMA接入  
C、 WLAN接入（WIFI）  
D、 卫星接入  

## TinyOS

TinyOS 是一个开源的（ 嵌入式 ）操作系统，它是由加州大学的伯里克分校所开发，主要应用于无线传感器网络方面。  
TinyOS 中，进行无线通信时主要通过调用相应的接口函数实现的。其中进行广播通信时，send 函数中目标节点的地址为_______广播地址________。  
在TinyOS 环境中，若要编译并烧录程序到节点，同时设置节点的组号为03，节点号为08，则输入的命令为____makedw1installNID=08GRP=03bsl,/dev/ttyUSB0____。  
TinyOS 中，接口AMPacket 中的address()函数的功能为____获取数据包的目标地址_____。  
TinyOS 中，接口AMPacket 中的source()函数的功能为____获取数据包的源地址____。  
TinyOS 中，如果想要提取RSSI的值，应在___接收方___（填发送方、接收方）提取。  

# 中间件

。。。

# 数据管理技术

。。。

---

# 简答题
